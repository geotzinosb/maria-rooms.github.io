const CACHE_VERSION="v3.0.0",CACHE_NAME=`maria-rooms-${CACHE_VERSION}`,STATIC_CACHE_NAME=`maria-rooms-static-${CACHE_VERSION}`,DYNAMIC_CACHE_NAME=`maria-rooms-dynamic-${CACHE_VERSION}`,CORE_PAGES=["/","/manifest.json"],STATIC_ASSETS=["/images/logo.svg","/images/favicon.svg","/images/logo-white.svg","/images/logo-compact.svg","/images/carousel/1.jpg","/images/carousel/2.jpg","/images/carousel/3.jpg","/images/carousel/4.jpg","/images/carousel/5.jpg","/images/carousel/6.jpg","/images/carousel/7.jpg","/images/carousel/8.jpg","/images/carousel/9.jpg","/images/carousel/10.jpg","/images/carousel/11.jpg","/images/carousel/12.jpg","/images/apartment-1.jpg","/images/apartment-2.jpg","/images/apartment-3.jpg","/images/apartment-4.jpg","/images/apartment-5.jpg","/images/apartment-6.jpg"],isDevelopment=self.location.hostname==="localhost"||self.location.hostname==="127.0.0.1";self.addEventListener("install",e=>{console.log(`Service Worker installing with version ${CACHE_VERSION}...`),self.skipWaiting(),e.waitUntil(Promise.all([caches.keys().then(e=>(console.log("Clearing old caches:",e),Promise.all(e.map(e=>{if(!e.includes(CACHE_VERSION))return console.log("Deleting old cache:",e),caches.delete(e)})))),caches.open(CACHE_NAME).then(e=>(console.log("Caching core pages:",CORE_PAGES),e.addAll(CORE_PAGES))).catch(e=>{console.error("Core pages cache failed:",e)}),caches.open(STATIC_CACHE_NAME).then(e=>(console.log("Caching static assets:",STATIC_ASSETS),e.addAll(STATIC_ASSETS))).catch(e=>{console.error("Static assets cache failed:",e)})]))}),self.addEventListener("activate",e=>{console.log(`Service Worker activating version ${CACHE_VERSION}...`),e.waitUntil(Promise.all([caches.keys().then(e=>Promise.all(e.map(e=>{if(!e.includes(CACHE_VERSION))return console.log("Deleting old cache on activate:",e),caches.delete(e)}))),self.clients.claim()]).then(()=>(console.log("Service Worker activated successfully"),Promise.resolve())).catch(e=>{console.log("Service Worker activation failed:",e)}))}),self.addEventListener("fetch",e=>{const t=new URL(e.request.url);if(t.origin!==self.location.origin||e.request.method!=="GET")return;if(e.request.url.includes("livereload")||e.request.url.includes("_framework")||e.request.url.includes("hot-reload")||e.request.url.includes("localhost:1313")||e.request.url.includes("localhost:1314")||e.request.url.includes("admin")||e.request.url.includes("wp-admin"))return;const i=t.pathname==="/"||t.pathname.endsWith(".html")||!t.pathname.includes("."),o=t.pathname.match(/\.(css|js)$/)&&t.pathname.includes("."),n=t.pathname.match(/\.(jpg|jpeg|png|svg|gif|webp|ico)$/i),s=t.pathname.match(/\.(woff|woff2|ttf|eot)$/i),a=t.pathname.includes("manifest.json");if(isDevelopment){e.respondWith(fetch(e.request).then(t=>{if(t.status===200){const o=t.clone(),i=n||s?STATIC_CACHE_NAME:DYNAMIC_CACHE_NAME;caches.open(i).then(t=>{t.put(e.request,o)}).catch(e=>{console.log("Cache update failed:",e)})}return t}).catch(()=>caches.match(e.request)));return}i||a?e.respondWith(fetch(e.request).then(t=>{if(t.status===200){const n=t.clone();caches.open(DYNAMIC_CACHE_NAME).then(t=>{t.put(e.request,n)})}return t}).catch(()=>caches.match(e.request))):o||n||s?e.respondWith(caches.match(e.request).then(t=>t?(o&&fetch(e.request).then(t=>{if(t.status===200){const n=t.clone();caches.open(STATIC_CACHE_NAME).then(t=>{t.put(e.request,n)})}}).catch(()=>{}),t):fetch(e.request).then(t=>{if(t.status===200){const o=t.clone(),i=n||s?STATIC_CACHE_NAME:DYNAMIC_CACHE_NAME;caches.open(i).then(t=>{t.put(e.request,o)})}return t}))):e.respondWith(fetch(e.request).then(t=>{if(t.status===200){const n=t.clone();caches.open(DYNAMIC_CACHE_NAME).then(t=>{t.put(e.request,n)})}return t}).catch(()=>caches.match(e.request)))}),self.addEventListener("message",e=>{e.data&&e.data.type==="SKIP_WAITING"&&self.skipWaiting(),e.data&&e.data.type==="CLEAR_CACHE"&&e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>{if(!e.includes(CACHE_VERSION))return caches.delete(e)})))),e.data&&e.data.type==="CLEAR_ALL_CACHES"&&e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>caches.delete(e)))))})